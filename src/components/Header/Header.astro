---
import { ClubsLogo as Clubs } from '@devprotocol/clubs-core/layouts'
import type { ClubsPropsPages } from '@devprotocol/clubs-core'
import menuIcon from '../../assets/menu.svg'
import closeIcon from '../../assets/close.svg'

const { connection = true } = Astro.props as ClubsPropsPages & {
	connection?: boolean
}
---

<script>
	const menuButton = document.getElementById('menu-button')
	const closeButton = document.getElementById('close-button')
	const menu = document.querySelector('.menu')
	const menuItems = document.querySelectorAll('.menu-item')
	const body = document.body

	menuButton?.addEventListener('click', () => {
		menu?.classList.add('open')
		body.classList.add('no-scroll')
		menuItems.forEach((item, index) => {
			item.classList.add('active')
		})
	})

	closeButton?.addEventListener('click', () => {
		menu?.classList.remove('open')
		body.classList.remove('no-scroll')
		menuItems.forEach((item, index) => {
			item.classList.remove('active')
		})
	})
</script>
<style>
	:root {
		--r-globalnav-flyout-item-number: 0;
	}

	body.no-scroll {
		overflow: hidden;
	}

	.menu {
		transform: translateY(-100%);
		transition: transform 0.2s ease-out;

		&.open {
			filter: blur(0);
			transform: translateY(0);
		}

		a {
			font-size: 28px;
		}
	}

	@media (min-width: 768px) {
		.menu {
			transform: translateY(0);

			a {
				font-size: 0.93vw;
			}
		}
	}

	.menu-item {
		opacity: 0;
		transform: translateY(-8px);
		transition-delay: calc(0.2s + var(--r-globalnav-flyout-item-number) * 20ms);
		transition-duration: 0.24s;
		transition-property: opacity, transform, visibility;
		transition-timing-function: ease-in-out, ease-in-out, step-start;

		&.active {
			opacity: 1;
			visibility: visible;
			transform: translate(0);
		}
	}

	@media (min-width: 768px) {
		.menu-item {
			opacity: 1;
			transform: translateY(0);
			transition: none;
			transition-delay: 0s;
		}
	}
</style>
<header
	class="absolute z-10 flex w-full items-center justify-between px-[3.70vw] py-[1.27vw]"
>
	<div class="flex items-center">
		<a href="https://www.clubs.place/" class="mr-[2.08vw] block">
			<span
				class="flex h-10 w-10 items-center justify-center rounded-full bg-[var(--backgroundColor)] p-1"
			>
				<Clubs class="h-full" />
			</span>
		</a>
		<ul
			class:list={[
				'menu fixed left-0 top-0 flex h-[100vh] w-[100vw] flex-col gap-4 bg-black px-10 py-12 font-bold text-white', // MB
				'md:relative md:h-auto md:w-auto md:flex-row md:gap-4 md:bg-transparent md:px-0 md:py-0', // PC
			]}
			class=""
		>
			<button
				id="close-button"
				class="menu-item absolute right-0 top-0 h-12 w-12 md:hidden"
			>
				<img src={closeIcon.src} alt="close" />
			</button>
			<li class="menu-item" style="--r-globalnav-flyout-item-number: 2">
				<a href="#">Creators</a>
			</li>
			<li class="menu-item" style="--r-globalnav-flyout-item-number: 4">
				<a href="＃">Community</a>
			</li>
			<li class="menu-item" style="--r-globalnav-flyout-item-number: 6">
				<a href="＃">News</a>
			</li>
		</ul>
	</div>

	<!--
	<div
		class="container mx-auto flex max-w-7xl items-center justify-between px-6 xl:px-0"
	>
		<i class="" role="presentation"></i>
		{connection && <slot name="header:connect-button" />}
	</div>
	-->
	<button id="menu-button" class="block md:hidden">
		<img src={menuIcon.src} alt="menu" />
	</button>
</header>
