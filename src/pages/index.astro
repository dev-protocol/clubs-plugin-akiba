---
import type { Membership } from '@devprotocol/clubs-core'
import { type ClubsPropsPages } from '@devprotocol/clubs-core'
import type { CheckoutFromPassportOffering } from '@devprotocol/clubs-plugin-passports'

import type { SectionOrderingValue } from '..'
import Home from '../components/Home/Pages.vue'
import type {
	CategoriesConfig,
	ComposedItem,
	HomeConfig,
	Product,
} from '../types'

type Props = ClubsPropsPages & {
	memberships?: Membership[]
	homeConfig: HomeConfig
	name: string
	sectionsOrderConfig: SectionOrderingValue
	clubsPaymentsOverrides: ComposedItem[]
	products: Product[]
	categories: CategoriesConfig
	base: string
}

const { base, homeConfig, products, categories } = Astro.props

const langs = Astro.request.headers.get('accept-language')?.split(',') ?? ['en']
---

<Home
	client:load
	base={base}
	homeConfig={homeConfig}
	langs={langs}
	products={products.filter(
		({ product }) => product.props.offering.hidden !== true,
	)}
	categories={categories}
/>
